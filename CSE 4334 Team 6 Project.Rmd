---
title: "CSE 4334 Team 6 Project"
output: html_document
author: "Azmi Alinufael, Maheer Jawwad, Sujana Kabir"
date: "2025-11-07"
---

Preparing Data

```{r}
# Load necessary libraries
# additional libraries can be added as needed

library(ggplot2)
library(caret)
library(dplyr)
library(corrplot)


```

```{r}
#Loading and Reading Dataset

insure <- read.csv("insurance.csv")

# Exploring the structure of the dataset
summary(insure)

# Checking for missing values
# looks clean, no missing values so far
sum(is.na(insure))

```

## Initial EDA

```{r}
# Wanted to see which numeric variables are correlated.
# selecting only numeric columns first 
numeric_insure <- insure %>% select_if(is.numeric)
cor_matrix <- cor(numeric_insure)

# Plotting the heatmap
corrplot(cor_matrix, method = "color", addCoef.col = "black", type="upper", diag=FALSE)

```

It looks like age and bmi have some positive correlation with charges, but it's not super strong. We probably need to look at the categorical variables too.

```{r}
# Checking the distribution of our target variable, charges
ggplot(insure, aes(x = charges)) +
  geom_histogram(bins = 30, fill = "grey", color = "white") +
  labs(title = "Distribution of Insurance Charges") +
  theme_minimal()

```

The charges are heavily skewed to the right. Most people have lower charges, but there's a long tail of expensive claims. May have to fix this later (maybe log transformation) to make the regression work better.

# Baseline Linear Regression

haven't split the data into train/test yet.

```{r}
# Naive model
baseline_model <- lm(charges ~ ., data = insure)

summary(baseline_model)

```

R-squared around 0.75 means 75% of the insurance charge variance can be explained by this model. Also to note, all else being equal, being a smoker is associated with paying roughly \$24,421 more in charges than a non-smoker.


```{r}


# Basic numeric summaries
summary(insure)

# Mean charges by smoker status and gender
insure %>%
  group_by(smoker, sex) %>%
  summarise(mean_charges = mean(charges), .groups = "drop")

# Mean BMI and charges by region
insure %>%
  group_by(region) %>%
  summarise(avg_bmi = mean(bmi), avg_charge = mean(charges))


```
# Looks like smokers pay way more on average, and the southeast region has the highest average charges.

```{r}
# Histogram of charges
ggplot(insure, aes(x = charges)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white") +
  labs(title = "Distribution of Insurance Charges", x = "Charges", y = "Frequency")

# Histogram of BMI
ggplot(insure, aes(x = bmi)) +
  geom_histogram(bins = 25, fill = "orange", color = "black") +
  labs(title = "Distribution of BMI", x = "BMI", y = "Count")

# Boxplot of Charges by Smoker Status
ggplot(insure, aes(x = smoker, y = charges, fill = smoker)) +
  geom_boxplot() +
  labs(title = "Charges by Smoking Status", y = "Insurance Charges")

```
# Smokers have a much wider range of charges, with many outliers on the high end.

```{r}
# Scatter: Age vs Charges
ggplot(insure, aes(x = age, y = charges, color = smoker)) +
  geom_point(alpha=0.6) +
  labs(title = "Age vs Charges (Smoker Highlighted)")

# Scatter: BMI vs Charges
ggplot(insure, aes(x = bmi, y = charges, color = smoker)) +
  geom_point(alpha=0.6) +
  labs(title = "BMI vs Charges (Smoker Highlighted)")

```

